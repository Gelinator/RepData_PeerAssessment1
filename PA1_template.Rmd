---
title: "Reproducible Research: Peer Assessment 1"
output: 
html_document:
keep_md: true
---
## Puropose

The following codes are used to perform data manipulations and ensuing analysis in order to answer the following questions.  

1. What is the mean total number of steps taken per day?
2. What is the average daily activity pattern?
3. Inputing the missing value  
a. Report total number of NAs  
b. Devise a strategy for filling in all of the missing values in the    dataset. The strategy does not need to be sophisticated. For example, you could use the mean/median for that day, or the mean for that 5-minute interval, etc.
4. Are there differences in activity patterns between weekdays and weekends?  

The following is a step by step processing codes, as well as their results when applied to the activity data.

## Loading and preprocessing the data

```{r, echo=TRUE}
setwd("~/GitHub/RepData_PeerAssessment1")

if (file.exists("activity.zip")==FALSE){
        
        download.file("https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip", destfile="activity.zip", method="curl")
        }

unzip("activity.zip")
data <- read.csv("activity.csv")

data$date <- as.Date(data$date)

```

## Loading necessary packages

```{r, echo=TRUE}
library(plyr)
library(ggplot2)
```


## What is mean total number of steps taken per day?

```{r, echo=TRUE}
library(plyr)
total <- ddply(data,"date",summarize, sum = sum(steps))


plot(total$date,total$sum, type="h")

#average
mean(total$sum,na.rm=TRUE)
#median
median(total$sum,na.rm=TRUE)
````

## What is the average daily activity pattern?

```{r, echo=TRUE}
inter <- ddply(data,"interval",summarize, TotalSteps = sum(steps,na.rm=TRUE))

plot(inter$interval,inter$TotalSteps, type="l")
````

## Imputing missing values

```{r, echo=TRUE}
# 1. Report total number of NAs 
sum(is.na(data))

# 2. Devise a strategy for filling in all of the missing values in the dataset. The strategy does not need to be sophisticated. For example, you could use the mean/median for that day, or the mean for that 5-minute interval, etc.

boom <- ddply(data, .(interval), transform, steps=ifelse(is.na(steps), median(steps, na.rm=TRUE), steps))

blah <- ddply(boom,"date",summarize, sum = sum(steps))
plot(blah$date,blah$sum, type="h")

#average
mean(blah$sum,na.rm=TRUE)
#median
median(blah$sum,na.rm=TRUE)
```

## Are there differences in activity patterns between weekdays and weekends?

```{r, echo=TRUE}
DayType <- data
DayType$days <- weekdays(as.Date(DayType$date))
DayType$daytype[DayType$days == "Monday" | DayType$days == "Tuesday" | DayType$days == "Wednesday" | DayType$days == "Thursday" | DayType$days == "Friday"] <- "Weekday"
DayType$daytype[DayType$days == "Saturday" | DayType$days == "Sunday"] <- "Weekend"


IntervalDay <- ddply(DayType,.(daytype,interval),summarize, MeanSteps = mean(steps,na.rm=TRUE))

qplot(interval,MeanSteps, data = IntervalDay, colour = daytype, geom="smooth")

```